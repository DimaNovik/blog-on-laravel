<template>
    <b-row>
        <b-col>
            <b-table striped
                     hover
                     responsive
                     :items="value"
                     :fields="fields"
                     :filter="getFilterText"
                     :current-page="currentPage"
                     :per-page="perPage"
                     @row-clicked="showDetails">
                <template v-slot:cell(type)="row">
                    <span v-if="row.item.type == 1" class="success">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 492 492" class="table-icon"><path fill="#3caea3" stroke="#3caea3" d="M419.9 72.1C373.4 25.7 311.7 0 246 0S118.5 25.6 72.1 72.1C25.6 118.5 0 180.3 0 246s25.6 127.5 72.1 173.9C118.5 466.4 180.3 492 246 492s127.5-25.6 173.9-72.1C466.3 373.4 492 311.7 492 246s-25.6-127.5-72.1-173.9zM246 456c-115.8 0-210-94.2-210-210S130.2 36 246 36s210 94.2 210 210-94.2 210-210 210z"/><path fill="#3caea3" d="M373.6 183.4l-43.5-43.8c-7-7-18.4-7.1-25.5-.1L243 200.8c-7 7-7.1 18.4-.1 25.5 7 7 18.4 7.1 25.5.1l48.8-48.6 18.2 18.3-118.7 118.1-60.3-60.6 18.3-18.2 29.3 29.5c7 7 18.4 7.1 25.5.1 7-7 7.1-18.4.1-25.5l-42-42.3c-3.4-3.4-7.9-5.3-12.7-5.3h-.1c-4.8 0-9.3 1.9-12.7 5.2l-43.9 43.6c-3.4 3.4-5.3 7.9-5.3 12.7 0 4.8 1.9 9.4 5.2 12.7l85.6 86.1c3.4 3.4 7.9 5.3 12.7 5.3h.1c4.8 0 9.3-1.9 12.7-5.2l144.3-143.5c3.4-3.4 5.3-7.9 5.3-12.7 0-4.8-1.9-9.4-5.2-12.7z"/></svg>
                    </span>

                    <span v-else>
                        <a href="#"
                           size="sm"
                           variant="warning"
                           title="Занести оплату"
                           @click.prevent="openInvoice(
                                      {id : row.item.id,
                                      create: row.item.created_at,
                                      code: row.item.code || '',
                                      fio: row.item.fio,
                                      })">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" class="table-icon"><path fill="#ed553b" d="M3 12c-1.65 0-3 1.35-3 3v28c0 1.65 1.35 3 3 3h1v3c0 1.65 1.35 3 3 3h33.18c-.12.31-.18.65-.18 1 0 1.65 1.35 3 3 3h18c1.65 0 3-1.35 3-3 0-1.28-.815-2.37-1.95-2.799l-1.52-3.99a9.057 9.057 0 00-3.95-4.611l-.34-.19A.463.463 0 0156 41c0-.17.09-.33.24-.41l.34-.19a9.057 9.057 0 003.95-4.61l1.52-3.99A2.987 2.987 0 0064 29c0-1.65-1.35-3-3-3h-1v-5c0-1.65-1.35-3-3-3h-1v-3c0-1.65-1.35-3-3-3H3zm0 2h50c.55 0 1 .45 1 1v11H43c-1.65 0-3 1.35-3 3 0 1.4.97 2.59 2.28 2.91l1.54 4.03c.7 1.83 2 3.41 3.66 4.44l.3.18c.14.09.22.24.22.48 0 .16-.08.31-.23.4l-.29.18A9.012 9.012 0 0044.94 44H3c-.55 0-1-.45-1-1V15c0-.55.45-1 1-1zm12 2a1 1 0 00-1 1v2a1 1 0 102 0v-2a1 1 0 00-1-1zm5 0a1 1 0 00-1 1v2a1 1 0 102 0v-2a1 1 0 00-1-1zm5 0a1 1 0 00-1 1v2c0 .051.022.096.03.145C21.054 20.942 19 24.678 19 29s2.055 8.058 5.03 9.855c-.008.05-.03.094-.03.145v2a1 1 0 102 0v-1.283A7.45 7.45 0 0028 40a7.45 7.45 0 002-.283V41a1 1 0 102 0v-2c0-.051-.022-.096-.03-.145C34.946 37.058 37 33.322 37 29s-2.055-8.058-5.03-9.855c.008-.05.03-.094.03-.145v-2a1 1 0 10-2 0v1.283A7.45 7.45 0 0028 18a7.45 7.45 0 00-2 .283V17a1 1 0 00-1-1zm11 0a1 1 0 00-1 1v2a1 1 0 102 0v-2a1 1 0 00-1-1zm5 0a1 1 0 00-1 1v2a1 1 0 102 0v-2a1 1 0 00-1-1zM5 17a1 1 0 100 2h5a1 1 0 100-2H5zm41 0a1 1 0 100 2h5a1 1 0 100-2h-5zm-18 3c3.859 0 7 4.038 7 9s-3.141 9-7 9-7-4.038-7-9 3.141-9 7-9zm28 0h1c.55 0 1 .45 1 1v5h-2v-6zm-46 5c-2.206 0-4 1.794-4 4s1.794 4 4 4 4-1.794 4-4-1.794-4-4-4zm0 2c1.103 0 2 .897 2 2s-.897 2-2 2-2-.897-2-2 .897-2 2-2zm33 1h18c.55 0 1 .45 1 1s-.45 1-1 1H43c-.55 0-1-.45-1-1s.45-1 1-1zm1.45 4h15.38l-1.14 3-.03.07A7.04 7.04 0 0156 38.4c-.13.09-.27.18-.41.26l-.34.19A2.48 2.48 0 0054 41c0 .89.48 1.71 1.25 2.15l.34.19c.12.07.24.14.35.22.98.64 1.79 1.52 2.34 2.56.15.26.27.53.38.81l1.16 3.06V50H44.45l1.24-3.23a6.993 6.993 0 012.85-3.45l.29-.18c.73-.45 1.17-1.24 1.17-2.18 0-.86-.44-1.65-1.17-2.1l-.29-.18c-1.3-.8-2.31-2.03-2.85-3.45L44.45 32zM15 38a1 1 0 00-1 1v2a1 1 0 102 0v-2a1 1 0 00-1-1zm5 0a1 1 0 00-1 1v2a1 1 0 102 0v-2a1 1 0 00-1-1zm16 0a1 1 0 00-1 1v2a1 1 0 102 0v-2a1 1 0 00-1-1zm5 0a1 1 0 00-1 1v2a1 1 0 102 0v-2a1 1 0 00-1-1zM5 39a1 1 0 100 2h5a1 1 0 100-2H5zm1 7h37.85l-.03.06L42.31 50H7c-.55 0-1-.45-1-1v-3zm37 6h18c.55 0 1 .45 1 1s-.45 1-1 1H43c-.55 0-1-.45-1-1s.45-1 1-1z"/></svg>
                            </a>
                    </span>

                    <b-link :href="`score-pdf-create/${row.item.id}`"
                            size="sm"
                            class="ml-3"
                            variant="success"
                            target="_blank"
                            title="Рахунок">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 468.7 468.7" class="table-icon"><path fill="#20639B" d="M449.35 0h-430c-6.6 0-12 5.4-12 12s5.4 12 12 12h25.9v432.4c0 4.4 2.4 8.5 6.3 10.6s8.6 1.9 12.3-.6l52.1-34.7 52.3 34.8c4 2.7 9.3 2.7 13.3 0l52.1-34.7 52.3 34.8c4 2.7 9.3 2.7 13.3 0l52.1-34.7 52.3 34.8c2 1.3 4.3 2 6.6 2 1.9 0 3.9-.5 5.7-1.4 3.9-2.1 6.3-6.2 6.3-10.6l-.2-432.4h27.3c6.6 0 12-5.4 12-12s-5.4-12.3-12-12.3zm-51 434l-40.3-26.8c-4-2.7-9.3-2.7-13.3 0l-52.1 34.8-52.3-34.8c-4-2.7-9.3-2.7-13.3 0l-52.1 34.7-52.3-34.7c-4-2.7-9.3-2.7-13.3 0l-40.1 26.7v-410h329l.1 410.1z"/><path fill="#20639B" d="M124.45 191.6h125.7c6.6 0 12-5.4 12-12s-5.4-12-12-12h-125.7c-6.6 0-12 5.4-12 12s5.3 12 12 12zM124.45 233.3h94.2c6.6 0 12-5.4 12-12s-5.4-12-12-12h-94.2c-6.6 0-12 5.4-12 12s5.3 12 12 12zM312.95 191.6h31.4c6.6 0 12-5.4 12-12s-5.4-12-12-12h-31.4c-6.6 0-12 5.4-12 12s5.3 12 12 12zM312.95 233.3h31.4c6.6 0 12-5.4 12-12s-5.4-12-12-12h-31.4c-6.6 0-12 5.4-12 12s5.3 12 12 12zM124.45 95.3h125.7c6.6 0 12-5.4 12-12s-5.4-12-12-12h-125.7c-6.6 0-12 5.4-12 12s5.3 12 12 12zM124.45 136.9h94.2c6.6 0 12-5.4 12-12s-5.4-12-12-12h-94.2c-6.6 0-12 5.4-12 12s5.3 12 12 12zM312.95 95.3h31.4c6.6 0 12-5.4 12-12s-5.4-12-12-12h-31.4c-6.6 0-12 5.4-12 12s5.3 12 12 12zM312.95 136.9h31.4c6.6 0 12-5.4 12-12s-5.4-12-12-12h-31.4c-6.6 0-12 5.4-12 12s5.3 12 12 12zM124.45 289.1h125.7c6.6 0 12-5.4 12-12s-5.4-12-12-12h-125.7c-6.6 0-12 5.4-12 12s5.3 12 12 12zM124.45 330.7h94.2c6.6 0 12-5.4 12-12s-5.4-12-12-12h-94.2c-6.6 0-12 5.4-12 12s5.3 12 12 12zM312.95 289.1h31.4c6.6 0 12-5.4 12-12s-5.4-12-12-12h-31.4c-6.6 0-12 5.4-12 12s5.3 12 12 12zM312.95 330.7h31.4c6.6 0 12-5.4 12-12s-5.4-12-12-12h-31.4c-6.6 0-12 5.4-12 12s5.3 12 12 12z"/></svg>
                    </b-link>
                    <b-link :href="`pdf-create/${row.item.id}`"
                            size="sm"
                            class="ml-3"
                            variant="success"
                            target="_blank"
                            title="Квитанція">
                        <svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1280 1280" class="table-icon"><path fill="#20639B" d="M263.5 84.7c-4.7.7-17.7 5.3-20.5 7.3-1.4.9-3.6 2.1-5 2.5-3.8 1.1-13.2 6-18.3 9.5-7.6 5.1-14.5 15.1-18.1 26.4-3.6 10.9-3.7 24.2-.3 30.7 2.7 5 4.9 5.8 9.9 3.6 1.8-.9 6.2-2.8 9.8-4.3 18.4-7.7 32.2-13.8 37.2-16.5 2-1 4.2-1.9 4.9-1.9.6 0 3.3-1.1 6.1-2.5 9.3-4.7 10.3-4 16.4 11.2 4.9 12.4 4.6 13.3-5.9 18.2-4.5 2.1-9.3 4.2-10.7 4.6-1.4.4-3 1.1-3.6 1.6-.6.5-3.7 1.8-6.9 2.9-3.2 1.1-6.3 2.4-6.9 2.9-.6.4-2.9 1.4-5.1 2.1-2.2.7-4.7 1.9-5.5 2.6-.9.7-3.6 2-6 2.9-2.5.8-6.5 2.5-9 3.7-2.5 1.2-5.2 2.4-6 2.8-2.5 1.2-2.4 7.4.3 12.7 1.4 2.6 3.9 8.6 5.7 13.3 2.9 7.8 8.3 19.8 11.5 26 .7 1.4 3 6.8 5 12s4.8 12 6.2 15c1.3 3 3.5 7.7 4.8 10.5 1.2 2.7 3.2 7 4.3 9.5 1.1 2.5 2.4 5.6 2.7 7 .4 1.4 1.7 4.7 3 7.5 1.3 2.7 4.9 10.8 8 18 3.1 7.1 6.7 15.3 8.1 18.1 1.3 2.8 2.4 5.4 2.4 5.9 0 .9 4.2 10.9 7.5 18 5.8 12.5 7.6 16.5 10 23 1.4 3.8 3.4 8.8 4.4 11 1.1 2.2 3.7 7.8 5.9 12.5s5.3 12.1 7 16.5c1.7 4.4 4 9.8 5.1 12.1 1.1 2.2 2.3 5.2 2.6 6.7.4 1.5 1.9 3.7 3.3 4.8 3.1 2.4 6.9 2 14.1-1.5 8.3-4.2 15.5-7.5 23.1-10.6 12.5-5.2 16.1-6.7 25.6-10.9 10.1-4.6 12.4-4.9 14.6-2.4 3.7 4.3 9.3 19.4 8.9 23.9-.1 1.3-9.1 5.9-13.6 7-1.6.3-5 1.7-7.5 3-4.3 2.1-11.7 5.6-22.3 10.3-2.6 1.1-5.3 2.1-6 2.1-.6 0-2.5.7-4.2 1.6-1.6.9-5.8 2.7-9.2 4.1-3.6 1.4-6.9 3.5-7.8 4.9-1.5 2.3-1.5 2.9.5 8.2 1.2 3.1 2.7 6.6 3.4 7.7.7 1.1 1.9 3.8 2.6 6 .7 2.2 1.6 4.5 2.1 5.1.5.6 2.9 6.2 5.5 12.5 2.5 6.2 6.5 15.4 8.9 20.4 2.3 4.9 4.7 10.3 5.3 12 .6 1.6 2.7 6.8 4.7 11.5s4.3 10.3 5.1 12.5c.8 2.1 2.1 4.6 2.8 5.5.8.8 1.9 3.3 2.5 5.5.6 2.2 1.8 4.9 2.6 5.9.8 1.1 1.5 2.6 1.5 3.4 0 1.3 4.4 11.9 8.5 20.7 5 10.7 13.5 30.5 13.5 31.5 0 .7 1.1 3.3 2.5 5.9 1.3 2.5 3.8 8 5.5 12.1 1.7 4.1 4.2 9.6 5.5 12.1 1.4 2.6 2.5 5.2 2.5 5.9 0 1.2 7.7 19.4 12.5 29.5 4.1 8.7 8.5 19.3 8.5 20.5 0 .6.9 2.8 2 4.8s2.9 5.7 4 8.2c1.1 2.5 5.3 10.9 9.4 18.7 6.6 12.6 9.9 18.3 16.2 27.7 1 1.6 2.8 4.5 3.9 6.5 1.9 3.5 3.8 6.3 13 18.5 2.2 2.9 5.1 6.8 6.5 8.7 1.4 1.8 4.9 6 7.7 9.4 2.9 3.3 7.4 8.6 10 11.9 8 9.8 31.5 33.1 36.3 35.9 12.8 7.4 16.5 8.9 23.1 9.4 6.3.5 6.6.4 10.1-2.8 9.2-8.6 12.5-29.8 9.8-63.4-2-23.9-6.4-58.5-7.9-61.3-.5-.9-1.4-4.7-2-8.2-.7-3.6-2-9-3-12-1.1-3-2.6-8.2-3.4-11.5-3.4-13.6-10.8-35.3-13.7-40-1.1-1.8-2-3.8-2-4.6 0-.7-.8-3.1-1.9-5.3-6-13.1-8.1-17.9-8.1-18.9 0-.5-1.2-3.5-2.6-6.6-1.4-3.1-3.7-7.9-4.9-10.6-1.3-2.8-3.8-8.4-5.5-12.5-1.8-4.1-4.3-10-5.6-13-1.3-3-3.7-8.8-5.4-12.8-1.7-4.1-4.2-9.4-5.6-11.9-1.3-2.5-2.4-5.3-2.4-6.2 0-.9-.9-3-1.9-4.8-1.1-1.7-2.5-5-3.1-7.3-.6-2.3-2-5.6-3.1-7.3-1-1.8-1.9-3.9-1.9-4.8 0-.9-1.1-3.2-2.4-5.2-1.4-2-2.9-5.1-3.5-6.9-1.4-4.9-6.2-16-7.7-18.3-.8-1.1-1.4-2.6-1.4-3.5 0-.8-1.3-4.2-3-7.5-1.6-3.3-4.3-9.4-6.1-13.5-1.7-4.1-3.9-9.1-4.8-11-1-1.9-2.4-5.3-3.1-7.5-.7-2.2-2.1-5.3-3.1-7-1.1-1.6-1.9-3.6-1.9-4.3 0-1.3-4.4-11.4-8.1-18.3-1-2-1.9-4.3-1.9-5 0-.8-1.1-3.5-2.5-6.1-1.4-2.6-2.5-5.3-2.5-5.9 0-.7-1.4-4.2-3.1-7.8-6.1-13-8.7-18.7-10.7-23.6-4.3-10.8-8.4-20.2-10.7-25-3.9-8.2-7.5-16.3-7.5-17.1 0-.9-4.4-11.2-8.1-19.1-1.6-3.4-2.9-6.6-2.9-7.3 0-.6-.9-2.8-2-4.8-2.7-5.2-6.2-12.9-8.1-18.2-2.2-6-6.8-16.8-11.1-26-7.7-16.5-9.8-21.3-9.8-22.4 0-.6-1.1-3.4-2.5-6.1-1.3-2.8-2.5-5.7-2.5-6.6 0-.8-1.1-3-2.5-4.9-1.4-1.9-2.5-4.1-2.5-5 0-1-1.1-3.8-2.5-6.4-1.4-2.6-2.5-5.2-2.5-5.7 0-1.4-5.1-13.4-10.5-24.5-2.5-5.1-5.4-11.8-6.6-15-1.2-3.3-2.5-6.4-2.9-6.9-.4-.6-1.1-2.1-1.5-3.5-.8-2.8-4.5-11.1-8.1-18.3-1.3-2.6-2.4-5.3-2.4-6 0-.7-1-3-2.1-5.2-1.2-2.2-2.7-5.5-3.5-7.5-.7-1.9-2.9-7.3-4.9-12-2-4.7-4.3-10.3-5.1-12.5-.8-2.1-2.1-4.6-2.8-5.5-.8-.8-1.7-2.6-2.1-4-.6-2.2-2-5.4-7.8-18-1.6-3.4-12-13.4-18.3-17.6-2.8-1.9-7.6-4.3-10.7-5.3-5.7-2-18.7-3.3-24.2-2.4zM165.9 182.8c-9.7 3.9-13.8 7.6-15.4 14-1.2 4.7-1.2 6 .4 12 2 7.4 5.7 16.5 8.4 20.5.9 1.5 1.7 3.1 1.7 3.7 0 .6 1.1 3.3 2.5 6s2.5 5.5 2.5 6.2c0 .7 1.4 4 3 7.3s3 6.5 3 7c0 .6 2 5.2 4.5 10.3 4.2 8.6 5.9 12.4 10.6 24.7 1.1 2.7 2.6 6.3 3.4 8 4.6 10 7.4 16.3 8 18.5.4 1.4 1.6 3.7 2.6 5.1 1 1.4 2.1 3.8 2.5 5.5.3 1.6 1.5 4.7 2.5 6.9s3.2 7.4 4.9 11.5c1.7 4.1 4.4 10.2 6 13.5 1.5 3.3 3.5 7.6 4.3 9.5 1.4 3.3 2.4 5.5 7.8 19.2 1.1 2.9 4.3 9.8 7 15.3 2.7 5.6 4.9 10.6 4.9 11.3 0 .7.9 2.9 2 4.9 1.1 2.1 2 4.5 2 5.3 0 .8 1.4 4.2 3 7.5 1.7 3.3 3 6.5 3 7.1 0 .6.7 1.7 1.5 2.4s2.2 3.5 3 6.3c.8 2.8 2.1 6 2.9 7.2.8 1.2 2 4 2.6 6.3 3.6 11.7 19.2 15.9 27.5 7.4 1.9-2 3.7-4.9 4.1-6.5.9-4-.5-11.7-2.6-14.7-.9-1.4-2.3-4.3-3-6.5-.7-2.2-1.7-4.5-2.1-5.1-.5-.6-1.8-3.6-2.8-6.6-1-3-2.4-6.3-2.9-7.4-.6-1-2.7-5.7-4.7-10.4-1.9-4.7-4.6-10.6-6-13.3-1.4-2.6-2.5-5.3-2.5-6 0-.7-.9-3-1.9-5.1-1.1-2.1-3.6-7.9-5.6-12.9-2-5.1-4-9.9-4.5-10.7-.6-.8-1.5-2.6-2.1-4-1.5-3.6-6.8-15.8-9-20.8-1-2.3-1.9-4.8-1.9-5.4 0-.6-1.5-4.3-3.4-8.2-6.3-13.3-9.3-20.1-11.6-26.1-2.2-5.6-5.8-13.8-10-23-5.7-12.3-7.2-15.7-8-18.2-1.2-4-6.1-15.6-10.3-24.3-4.6-9.7-8.7-20.7-8.7-23.3 0-1.1.9-3.5 2.1-5.4 1.8-2.8 2-4.5 1.7-10.1-.5-8.1-3.8-13.5-10.1-16.9-5.4-2.9-8.7-2.8-16.8.5z"/><path fill="#20639B" d="M132 449.9c-2 .4-4.1 1.1-4.8 1.5-.9.6-1.2 70.7-1.2 321.5 0 314.4 0 320.9 1.9 323.2l1.9 2.4 523.2.3 523.1.2 2.4-2.5 2.5-2.4V773.6c0-290-.1-320.6-1.6-322-.8-.9-2.1-1.6-2.7-1.6H840.1c-302.4-.1-335.6.1-337 1.5-1.4 1.4-1.3 2.1 1.1 6.8 1.5 2.9 3.1 6.5 3.7 8.2 1.9 5.9 6.3 16 7.6 17.5.7.8 1.6 2.6 1.9 4 .4 1.4 1.8 4.7 3.1 7.5 1.3 2.7 3.8 8.8 5.5 13.5 1.8 4.7 3.8 9.6 4.6 11 2.4 4.6 8.2 17.5 8.9 20 .4 1.4 1.3 3.4 2 4.5.6 1.1 1.8 3.8 2.5 6s1.9 4.9 2.5 6c.7 1.1 1.8 3.7 2.5 5.8.7 2.1 2.6 5.4 4.2 7.3l3 3.4h291.2c160.1 0 291.6.4 292.2.8.6.4 1.6 1.7 2.3 2.9 1.6 3.1 1.6 478.5 0 481.6-.7 1.2-1.7 2.5-2.3 2.9-1.5 1-969.8 1-971.3 0-.6-.4-1.6-1.9-2.1-3.2-.6-1.5-1-96.7-1-241.2l-.1-238.7 2-2.6 2.1-2.6 83.5.1c63.5.1 83.8-.1 84.9-1 1.8-1.6 1.8-5.1-.1-7.6-.8-1-2-3.7-2.6-5.9-.6-2.2-2-5.2-3-6.6-1-1.5-1.9-3.3-1.9-3.9 0-.7-1.6-4.7-3.6-8.9-6.6-14-7.2-15.6-10.4-24.1-1.8-4.7-3.9-9.3-4.8-10.3-2.1-2.3-5.5-2.1-8.9.6-1.5 1.2-5.5 3.4-8.8 4.7-8.5 3.5-22.3 3.6-31 .1-11.7-4.7-20.7-11.7-27.5-21.5-3-4.4-10-19-10-20.9 0-.5-1.8-4.7-4-9.3l-4-8.4h-36.4c-20 0-38.3-.2-40.7-.4-2.4-.3-6-.1-7.9.3z"/><path fill="#f6d55c" d="M620.8 727c-1.6.4-2.4 1.4-2.6 3.4-.4 3.2 2.3 10.4 4.7 12.3 1.2 1 47.8 1.3 225.6 1.3 254.4 0 228.5 1 228.5-9 0-5.1-.3-6.1-2.2-7.2-1.8-.9-50.1-1.2-227-1.3-123.6 0-225.7.2-227 .5zM233.2 728.6c-2 1.4-2.3 2.3-2 7.2.3 4.9.6 5.8 2.8 6.9 3.8 1.9 176.3 1.9 177.9 0 2-2.4-2.9-13.7-6.5-15.1-.9-.3-39.5-.6-85.8-.6-75.3 0-84.4.2-86.4 1.6zM234.3 850c-2.6 1-3.6 5.1-3.1 12.5.2 4.1.7 5.2 2.8 6.2 2 1 28.9 1.3 126.6 1.3 110.4 0 124.3-.2 125.4-1.5 1.7-2.1.5-4.2-6.9-12.5l-5.9-6.5-118.3-.2c-67.4-.1-119.3.2-120.6.7zM639.2 850.2c-.7.7-1.2 4.3-1.2 9.3 0 5 .5 8.6 1.2 9.3.9.9 50.5 1.2 217 1.2H1072l2.1-2.1c1.9-1.9 2.1-3 1.6-9.2-.3-5.2-.9-7.4-2.3-8.4-2.5-1.8-432.3-2-434.2-.1zM691.5 975.2c-2.6 2.1-2.7 2.4-2.3 9.4.3 4 1.1 8 1.8 8.9 1.1 1.3 21.7 1.5 192.2 1.5h190.9l1.5-3.5c2.2-5.4 1.9-13.8-.7-16.1-2.1-1.9-6.9-1.9-191.4-2.2l-189.2-.2-2.8 2.2z"/></svg>
                    </b-link>

                    <b-link href="#"
                            size="sm"
                            class="ml-3"
                            variant="success"
                            target="_blank"
                            title="Редагувати">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 488.877 488.877" class="table-icon"><path fill="#20639B" stroke="#20639B" d="M488.3 100.567c-.7-1.6-1.1-3.6-1.5-5.6-1.1-5.3-2.3-11.2-5-17.2-15-34.2-39.8-58.5-73.7-72.2-7.3-3-14.6-3.9-21-4.6l-1.6-.2c-7.4-.9-18.4.1-28.7 10.6-43.7 43.9-88.2 88.4-131.3 131.5l-31.6 31.5-11.5 11.5-2.7 2.7c-1.3 1.3-4 4.1-11.8 12-7 7.1-6.9 18.5.2 25.5 7.1 7 18.5 6.9 25.5-.2 7.9-8 10.6-10.8 11.9-12.1l2.4-2.4 11.5-11.5 31.6-31.6c43.1-43.1 87.6-87.6 131.4-131.6l.1-.1h.3c4.6.6 9 1.1 11.9 2.3 25.3 10.2 43 27.7 54.3 53.3 1.1 2.6 1.9 6.2 2.7 10.1.2 1 .4 1.9.6 2.9l-.4.4c-72 71.8-146.9 146.7-229.2 229.1-.4.4-.4.4-1.1.6-27.6 5.8-55.6 11.7-82.6 17.4l-4.3.9.8-3.7c5.8-27.5 11.8-55.9 17.9-83.8 2.1-9.7-4-19.3-13.7-21.4-9.7-2.1-19.3 4-21.4 13.7-6.1 28-12.1 56.5-17.9 84.1l-3.3 15.6c-2 9.6.7 19.3 7.3 25.9 5.2 5.2 12.2 8 19.7 8 2.1 0 4.2-.2 6.3-.7l16.3-3.4c27.1-5.7 55-11.6 82.5-17.4 7.6-1.6 13.9-5 19.2-10.4 82.2-82.4 157.2-157.3 229.1-229.1 6.7-6.7 10.4-14.7 11.3-24.3.2-2 0-4.1-.5-6.1z"/><path fill="#20639B" d="M387.7 263.767c-9.9 0-18 8.1-18 18v162.7c0 4.4-3.5 7.9-7.9 7.9H43.9c-4.4 0-7.9-3.5-7.9-7.9v-317.9c0-4.4 3.5-7.9 7.9-7.9h169.6c9.9 0 18-8.1 18-18s-8.1-18-18-18H43.9c-24.2 0-43.9 19.7-43.9 43.9v317.9c0 24.2 19.7 43.9 43.9 43.9h317.9c24.2 0 43.9-19.7 43.9-43.9v-162.7c0-9.9-8.1-18-18-18z"/></svg>
                    </b-link>

                    <b-link href="#"
                            size="sm"
                            class="ml-3"
                            variant="success"
                            target="_blank"
                            title="Видалити"
                            @click.prevent="deleteAction(row.item.id)">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 486.4 486.4" class="table-icon"><path fill="#ed553b" d="M446 70H344.8V53.5c0-29.5-24-53.5-53.5-53.5h-96.2c-29.5 0-53.5 24-53.5 53.5V70H40.4c-7.5 0-13.5 6-13.5 13.5S32.9 97 40.4 97h24.4v317.2c0 39.8 32.4 72.2 72.2 72.2h212.4c39.8 0 72.2-32.4 72.2-72.2V97H446c7.5 0 13.5-6 13.5-13.5S453.5 70 446 70zM168.6 53.5c0-14.6 11.9-26.5 26.5-26.5h96.2c14.6 0 26.5 11.9 26.5 26.5V70H168.6V53.5zm226 360.7c0 24.9-20.3 45.2-45.2 45.2H137c-24.9 0-45.2-20.3-45.2-45.2V97h302.9v317.2h-.1z"/><path fill="#ed553b" d="M243.2 411c7.5 0 13.5-6 13.5-13.5V158.9c0-7.5-6-13.5-13.5-13.5s-13.5 6-13.5 13.5v238.5c0 7.5 6 13.6 13.5 13.6zM155.1 396.1c7.5 0 13.5-6 13.5-13.5V173.7c0-7.5-6-13.5-13.5-13.5s-13.5 6-13.5 13.5v208.9c0 7.5 6.1 13.5 13.5 13.5zM331.3 396.1c7.5 0 13.5-6 13.5-13.5V173.7c0-7.5-6-13.5-13.5-13.5s-13.5 6-13.5 13.5v208.9c0 7.5 6 13.5 13.5 13.5z"/></svg>
                    </b-link>
                </template>
            </b-table>

            <p v-if="!value.length">Дані відстуні</p>

            <b-pagination
                    v-model="currentPage"
                    :total-rows="totalRows"
                    :per-page="perPage"
                    size="sm"
                    v-if="value.length"
            ></b-pagination>

            <InvoicePopup
                    :isActive="isOpenSavePayment"
                    :item="rowPaymentData"
                    @showPopup="successPayment"/>

            <MorePopup
                    :isActive="isOpenMore"
                    :item="getMoreInfo"
                    @showPopup="closeMore"/>
        </b-col>
    </b-row>
</template>

<script>
    import InvoicePopup from './SavePayment';
    import MorePopup from './MoreInfo';
    import {mapActions, mapGetters, mapMutations} from 'vuex';

    export default {
        name: "ServicesTable",
        props: {
            filter: {
                type: String,
                default() {
                    return ''
                }
            },
            value: {
                type: Array, Object,
                default() {
                    return []
                }
            }
        },
        data() {
            return {
                totalRows: 1,
                currentPage: 1,
                perPage: 10,
                fields: [
                    {
                        key: "code",
                        label: "Код дії",
                        sortable: true
                    },
                    {
                        key: "fio",
                        label: "ПІБ платника",
                        sortable: true
                    },
                    {
                        key: "count",
                        label: "Кількість",
                        sortable: true
                    },
                    {
                        key: "price",
                        label: "Вартість",
                        sortable: true
                    },
                    {
                        key: "created_at",
                        label: "Дата створення",
                        sortable: true
                    },
                    {
                        key: "action_date",
                        label: "Дата над.пос.",
                        sortable: true
                    },
                    {
                        key: "pay_date",
                        label: "Дата оплати",
                        sortable: true
                    },
                    {
                        key: "type",
                        label: "Статус",
                        sortable: true
                    },

                ],
                isOpenSavePayment: false,
                rowPaymentData: null,
                isShowDetails: false,
                isOpenMore: false
            }
        },
        components: {
            InvoicePopup,
            MorePopup
        },
        computed: {
            ...mapGetters('Calculator', ['moreInfo']),
            getFilterText() {
                return this.filter
            },
            getMoreInfo() {
                return this.moreInfo || {}
            }
        },
        methods: {
            ...mapActions('Calculator', ['getOnceAction', 'getOnceService']),
            ...mapActions('Orders', ['deleteOrder']),
            ...mapMutations('Calculator', ['clearMoreInfo']),
            getPDF(id) {
                this.$router.push(`pages/calculator/pdg-create/${id}`)
            },
            openInvoice(data) {
                this.isOpenSavePayment = true;
                this.rowPaymentData = data;
            },
            successPayment() {
                this.isOpenSavePayment = false;
                this.$emit('update');
            },
            showDetails(record, index) {
                let services = JSON.parse(record.service_id);

                this.getOnceAction(record.action_id).then(() => {
                    this.isOpenMore = true;

                    services.forEach(item => {
                        this.getOnceService({id: item.service, count: item.count})
                    })

                })
            },
            closeMore() {
                this.isOpenMore = false;
                this.clearMoreInfo();
            },
            deleteAction(id) {

                if(confirm('Ви впевнені?')) {
                    this.deleteOrder(id).then(()=> {
                        this.$emit('update');
                    })
                }

            }
        },
        created() {
            this.totalRows = this.value.length
        },
    }
</script>